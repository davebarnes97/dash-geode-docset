<!doctype html>
<html>
<head>
  <meta charset="utf-8">
  <!-- Always force latest IE rendering engine or request Chrome Frame -->
  <meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible">

  
  <link href='https://fonts.googleapis.com/css?family=Source+Sans+Pro:300,300italic,400italic,400,600' rel='stylesheet' type='text/css'>
  <!-- Use title if it's in the page YAML frontmatter -->
  <title>
      Preventing and Recovering from Disk Full Errors |
    Geode Docs
  </title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link href="../../../stylesheets/all.css" rel="stylesheet" media="screen, print" />
  <link href="../../../stylesheets/print.css" rel="stylesheet" media="print" />
  <link href='../../../images/favicon.ico' rel='shortcut icon'>

  <script src="../../../javascripts/all.js"></script>
  
</head>

<body class="docs docs_managing docs_managing_troubleshooting docs_managing_troubleshooting_prevent_and_recover_disk_full_errors">

<div class="viewport">
  <div class='wrap'>
    <script type="text/javascript">
      document.domain = "apache.org";
    </script>

    <!--  -->

    <div class="container">

      <!--googleoff: index-->
      <!--  -->
      <!--googleon: index-->

      <main class="content content-layout" id="js-content" role="main">
        <a id="top"></a>
        <!--  -->
        <!--   <h1 class="title-container">
    Preventing and Recovering from Disk Full Errors
  </h1>
 -->
          <div id="js-quick-links" >
            
          </div>
        <div class="to-top" id="js-to-top">
          <a href="#top" title="back to top"></a>
        </div>
        <!--
Licensed to the Apache Software Foundation (ASF) under one or more
contributor license agreements.  See the NOTICE file distributed with
this work for additional information regarding copyright ownership.
The ASF licenses this file to You under the Apache License, Version 2.0
(the "License"); you may not use this file except in compliance with
the License.  You may obtain a copy of the License at

     http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
-->

<p>It is important to monitor the disk usage of Geode members. If a member lacks sufficient disk space for a disk store, the member attempts to shut down the disk store and its associated cache, and logs an error message. A shutdown due to a member running out of disk space can cause loss of data, data file corruption, log file corruption and other error conditions that can negatively impact your applications.</p>

<p>After you make sufficient disk space available to the member, you can restart the member.</p>

<p>You can prevent disk file errors using the following techniques:</p>

<ul>
<li>  If you are using ext4 file system, we recommend that you pre-allocate disk store files and disk store metadata files. Pre-allocation reserves disk space for these files and leaves the member in a healthy state when the disk store and regions are shut down, allowing you to restart the member once sufficient disk space has been made available. Pre-allocation is enabled by default.</li>
<li>  Configure critical usage thresholds (disk-usage-warning-percentage and disk-usage-critical-percentage) for the disk. By default, these are set to 90% for warning and 99% for errors that will shut down the cache.</li>
<li>  Follow the recommendations in <a href="../disk_storage/optimize_availability_and_performance.html#optimize_avail_disk_store">Optimizing a System with Disk Stores</a> for general disk management best practices.</li>
</ul>

<p>When a disk write fails due to disk full conditions, the member is shutdown and removed from the distributed system.</p>

<h2 id="recovering-from-disk-full-errors">Recovering from Disk Full Errors</h2>

<p>If a member of your Geode distributed system fails due to a disk full error condition, add or make additional disk capacity available and attempt to restart the member normally. If the member does not restart and there is a redundant copy of its regions in a disk store on another member, you can restore the member using the following steps:</p>

<ol>
<li> Delete or move the disk store files from the failed member.</li>
<li> Use the gfsh <code>show missing-disk-stores</code> command to identify any missing data. You may need to manually restore this data.</li>
<li> Revoke the missing disk stores using the <a href="../../tools_modules/gfsh/command-pages/revoke.html">revoke missing-disk-store</a> gfsh command.</li>
<li> Restart the member.</li>
</ol>

<p>See <a href="../disk_storage/handling_missing_disk_stores.html#handling_missing_disk_stores">Handling Missing Disk Stores</a> for more information.</p>

        <!-- 
 -->
      </main>
    </div>
  </div>
</div>

<div id="scrim"></div>

<div class="container">
  <footer class="site-footer-links">
    <!--  -->
  </footer>
</div><!--end of container-->

</body>
</html>
