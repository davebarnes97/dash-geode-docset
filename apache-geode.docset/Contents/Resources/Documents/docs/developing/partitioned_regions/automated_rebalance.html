<!doctype html>
<html>
<head>
  <meta charset="utf-8">
  <!-- Always force latest IE rendering engine or request Chrome Frame -->
  <meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible">

  
  <link href='https://fonts.googleapis.com/css?family=Source+Sans+Pro:300,300italic,400italic,400,600' rel='stylesheet' type='text/css'>
  <!-- Use title if it's in the page YAML frontmatter -->
  <title>
      Automated Rebalancing of Partitioned Region Data |
    Geode Docs
  </title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link href="/stylesheets/all.css" rel="stylesheet" media="screen, print" />
  <link href="/stylesheets/print.css" rel="stylesheet" media="print" />
  <link href='/images/favicon.ico' rel='shortcut icon'>

  <script src="/javascripts/all.js"></script>
  
</head>

<body class="docs docs_developing docs_developing_partitioned_regions docs_developing_partitioned_regions_automated_rebalance">

<div class="viewport">
  <div class='wrap'>
    <script type="text/javascript">
      document.domain = "apache.org";
    </script>

    <!--  -->

    <div class="container">

      <!--googleoff: index-->
      <!--  -->
      <!--googleon: index-->

      <main class="content content-layout" id="js-content" role="main">
        <a id="top"></a>
        <!--  -->
        <!--   <h1 class="title-container">
    Automated Rebalancing of Partitioned Region Data
  </h1>
 -->
          <div id="js-quick-links" >
            
          </div>
        <div class="to-top" id="js-to-top">
          <a href="#top" title="back to top"></a>
        </div>
        <!--
Licensed to the Apache Software Foundation (ASF) under one or more
contributor license agreements.  See the NOTICE file distributed with
this work for additional information regarding copyright ownership.
The ASF licenses this file to You under the Apache License, Version 2.0
(the "License"); you may not use this file except in compliance with
the License.  You may obtain a copy of the License at

     http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
-->

<p><strong>Note:</strong> This feature is experimental and is subject to change in future releases of Apache Geode.</p>

<p>Automated rebalance triggers a rebalance
(see <a href="rebalancing_pr_data.html">Rebalancing Partitioned Region Data</a>)
operation based on a
time schedule.
At the scheduled intervals, the balance of the partitioned regions
is evaluated based on configured criteria.
One criterion is a minimum threshhold for number of bytes that
would be transferred if the rebalance takes place.
The other criterion uses the ratio of the number of bytes
that would be transferred to the total number of bytes in the
regions.
If the evaluation indicates the system is out of balance,
the rebalance transfer is initiated.</p>

<p>To enable automated rebalance, specify the rebalance manager
in the <code>&lt;initializer&gt;</code> attribute within the <code>&lt;cache&gt;</code> configuration
of the <code>cache.xml</code> file:</p>
<pre class="highlight plaintext"><code>&lt;class-name&gt; org.apache.geode.cache.util.AutoBalancer &lt;/class-name&gt;
</code></pre>

<p>The time schedule that triggers an evaluation and possible rebalance
uses a cron-based specification in 
the <code>&lt;initializer&gt;</code> attribute within the <code>&lt;cache&gt;</code> configuration 
of the <code>cache.xml</code> file.
This scheduling specification is required.
Specify the cron expression in the Spring format.
This example specification triggers each Saturday at 3am:</p>
<pre class="highlight plaintext"><code>&lt;parameter name="schedule"&gt; 0 0 3 ? * SAT &lt;/parameter&gt;
</code></pre>

<p>This example specification triggers once each day at 4am:</p>
<pre class="highlight plaintext"><code>&lt;parameter name="schedule"&gt; 0 0 4 * * ?&lt;/parameter&gt;
</code></pre>

<p>The automated rebalance specifications that specify criteria for
triggering the rebalance are optional and have reasonable default values.</p>

<p>One criterion is a minimum number of bytes that would be transferred
if the rebalance were to take place.
The specification is in units of bytes; here is the specification
for the default value of 100MB:</p>
<pre class="highlight plaintext"><code>&lt;parameter name="minimum-size"&gt; 104857600&lt;/parameter&gt;
</code></pre>

<p>Another criterion represents the ratio of bytes that would be transferred
to the total number of bytes in the partitioned regions,
represented as an integer percentage.
The default is 10 percent.
This example specificies 15 percent:</p>
<pre class="highlight plaintext"><code>&lt;parameter name="size-threshold-percent"&gt; 15 &lt;/parameter&gt;
</code></pre>

        <!-- 
 -->
      </main>
    </div>
  </div>
</div>

<div id="scrim"></div>

<div class="container">
  <footer class="site-footer-links">
    <!--  -->
  </footer>
</div><!--end of container-->

</body>
</html>
